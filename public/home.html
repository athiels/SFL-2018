<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Sing for Life 2018</title>
    <!-- Bootstrap Core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom Fonts -->
    <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
    <!-- Plugin CSS -->
    <link href="vendor/magnific-popup/magnific-popup.css" rel="stylesheet">
    <!-- Theme CSS -->
    <link href="css/creative.css" rel="stylesheet">
		
	<link rel="icon" href="img/logo.png">
	<link rel="apple-touch-icon-precomposed" href="apple-touch-icon-precomposed.png">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body id="page-top">
    <nav id="mainNav" class="navbar navbar-default navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1"> <span class="sr-only">Toggle navigation</span> Menu <i class="fa fa-bars"></i> </button> <a class="navbar-brand page-scroll" href="#page-top" style="font-size:35px;">Sing for Life 2018</a> </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li> <a class="page-scroll" href="#about">SFL 2018</a> </li>
                    <li> <a class="page-scroll" href="#confirmation" id="confirmationLink">Aanvraag</a> </li>
                    <li> <a class="page-scroll" href="#allVideos" id="allVideosLink" style="display:none;" >Alle video's</a> </li>
                    <li> <a class="page-scroll" href="#contact">Contact</a> </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>
    <header>
        <div class="header-content">
            <div class="header-content-inner"> <a href="#about" class="page-scroll btn btn-dark btn-xl sr-button margin-top">Lees meer!</a> </div>
        </div>
    </header>
    <section class="bg-dark" id="about">
        <div class="container">
            <div class="row">
                <div class="col-lg-10 col-lg-offset-1 text-center">
                    <h2 class="section-heading" style="font-size:40px;">SFL goes back to basic</h2>
                    <hr class="light">
                    <p>
						De inmiddels <i class="blue">7e</i> editie van Sing for Life gaat door op <i class="blue">03 februari 2018</i>.
						<br>
						Jullie worden traditiegewijs verwacht <i class="blue">ten huize Thiels</i>
						<br>
						Elshoutbaan 34, 2930 Brasschaat, omstreeks 19.00 u.
					</p>
					
					<p>
						Het SFL-team probeert jullie elk jaar opnieuw te <i class="blue">verrassen</i> en dat is dit jaar niet anders.
						<i class="blue">Tradities</i> dienen in stand gehouden te worden: <i class="blue">eten</i> en <i class="blue">drinken</i> zal dus in overvloed aanwezig zijn. 
						<br>
						Het <i class="blue">muzikale</i> gedeelte zal dit jaar echter in een <i class="blue">nieuw (oud) jasje</i> gestoken worden.
                    <p>
						Voor â‚¬60 per persoon, kunnen jullie mee komen genieten van dit <i class="blue">culinaire</i> en <i class="blue">muzikale</i> topfeest. </p>
                    <p>					
						En vergeet onze immer geldende regel niet: 
						<br>
						enkel <i class="blue">sloefen, sokken </i>of gewassen <i class="blue">blote voeten</i> toegelaten.</p> <a href="#confirmation" class="page-scroll btn btn-default btn-xl sr-button">Ik zou graag komen!</a> </div>
            </div>
        </div>
    </section>	
    <section id="confirmation">
        <div class="container" id="notyetconfirmed">
            <div class="row">
                <div class="text-center">
                    <h2 class="section-heading" style="font-size:40px;">You're the star</h2>
                    <hr class="primary">
                    <p>
						Net zoals de afgelopen jaren zullen jullie er iets voor over moeten hebben om op onze aanwezigheidslijst terecht te komen.
						Wij zouden graag jullie muzikale kant beter leren kennen. 
						<br>
						Daarvoor zullen jullie een filmpje moeten opnemen (min 30, max 45 seconden) 
						waarin alle gezinsleden die willen meekomen samen een liedje brengen!
						<br>
						Zingen, een instrument bespelen, "oep ne kastrol kloppen",... het mag allemaal! Zolang we het liedje maar herkennen en iedereen tegelijkertijd meedoet.
					</p>
					
					<p>
						Upload het filmpje hieronder door op de knop <i>'Uploaden'</i> te klikken en het filmpje te selecteren.
						<br>
						Als jullie muzikale kunstwerk goedgekeurd wordt, zijn jullie welkom op 03/02/2018!
					</p>
					
					<form id="uploadForm">
						<input id="fileInput" type="file" style="display:none;"/>	
					</form>
					
					<div class="row">
						<br>
						<button type="submit" class="btn btn-default btn-xl sr-button" onclick='$("#fileInput").click();'>Uploaden!</button>
					</div>	
	
					<p class="red" id="err"  style="display: none;" >Oeps, er ging iets mis. Probeer het nog eens of contacteer het SFL-team!</p>
					<p class="red" id="err_ext" style="display: none;">Dit formaat wordt niet ondersteund.</p>
					
                </div>
            </div>
        </div>
		
		<div class="container" id="uploading">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <h2 class="section-heading" style="font-size:40px;">You're the star</h2>
                    <hr class="primary">
                    <h2 class="section-heading">We zijn jouw filmpje aan het uploaden...</h2>
					<p id="fname"></p>
                    <img src="/img/loading.gif"> 
                    <hr class="primary"> </div>
            </div>
        </div>
				
        <div class="container" id="confirmed">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <h2 class="section-heading" style="font-size:40px;">You're the star</h2>
                    <hr class="primary">
                    <h2 class="section-heading">Uploaden geslaagd!</h2>
                    <p>
						Uw aanvraag is in behandeling!
						<br>
						Als jullie filmpje goedgekeurd is, zullen jullie alle andere filmpjes hier ook te zien krijgen!
					</p>
					<img src="/img/success.png">
                    
            </div>
        </div>
    </section>
	
	<section class="bg-light" id="allVideos">
        <div class="container">
            <div class="row">
                <div class="col-lg-10 col-lg-offset-1 text-center">
                    <h2 class="section-heading" style="font-size:40px;">Alle reeds geuploade video's</h2>
                    <hr class="light">
					<div id="listVideos"></div>
				</div>
			</div>	
        </div>
    </section>
	
    <section id="pics" class="bg-dark">

        <div class="container-fluid no-padding">
            <div class="row no-gutter popup-gallery">
                <div class="col-lg-4 col-sm-6">
                    <a href="img/portfolio/fullsize/1.JPG" class="portfolio-box"> <img src="img/portfolio/thumbnails/1.JPG" class="img-responsive" alt=""> </a>
                </div>
                <div class="col-lg-4 col-sm-6">
                    <a href="img/portfolio/fullsize/2.JPG" class="portfolio-box"> <img src="img/portfolio/thumbnails/2.JPG" class="img-responsive" alt=""> </a>
                </div>
                <div class="col-lg-4 col-sm-6">
                    <a href="img/portfolio/fullsize/3.JPG" class="portfolio-box"> <img src="img/portfolio/thumbnails/3.JPG" class="img-responsive" alt=""> </a>
                </div>
                <div class="col-lg-4 col-sm-6">
                    <a href="img/portfolio/fullsize/4.JPG" class="portfolio-box"> <img src="img/portfolio/thumbnails/4.JPG" class="img-responsive" alt=""> </a>
                </div>
                <div class="col-lg-4 col-sm-6">
                    <a href="img/portfolio/fullsize/5.JPG" class="portfolio-box"> <img src="img/portfolio/thumbnails/5.JPG" class="img-responsive" alt=""> </a>
                </div>
                <div class="col-lg-4 col-sm-6">
                    <a href="img/portfolio/fullsize/6.JPG" class="portfolio-box"> <img src="img/portfolio/thumbnails/6.JPG" class="img-responsive" alt=""> </a>
                </div>
            </div>
        </div>
    </section>
	
    <section id="contact">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 text-center">
                    <h2 class="section-heading">Contact</h2>
                    <hr class="primary">
                    <h2 class="section-heading">Het SFL-team staat voor jullie klaar. Twijfel niet om ons te contacteren als je vragen hebt of extra informatie wenst!</h2> </div>
                <div class="col-lg-4 col-lg-offset-2 text-center"> <i class="fa fa-phone fa-3x sr-contact"></i>
                    <p>04 84 03 34 21</p>
                </div>
                <div class="col-lg-4 text-center"> <i class="fa fa-envelope-o fa-3x sr-contact"></i>
                    <p>arne.thiels@gmail.com</p>
                </div>
                <div class="col-lg-12 text-center">
                    <hr>
                <h3>In samenwerking met <img src="img/TOP-logo.png" style="width:10%">      </h3></div>
            </div>
			<div class="row text-center">
				<h3>Website door Arne Thiels</h3>
			</div>
        </div>
    </section>
    <!-- jQuery -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <!-- Bootstrap Core JavaScript -->
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
    <!-- Plugin JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
    <script src="vendor/scrollreveal/scrollreveal.min.js"></script>
    <script src="vendor/magnific-popup/jquery.magnific-popup.min.js"></script>
    <!-- Theme JavaScript -->
    <script src="js/creative.min.js"></script>
    <script>
				
		var allowedExtensions = ["mp4", "wmv", "avi", "3gp", "mov"];
		
		alreadyUploadedAndConfirmed = false;
		alreadyUploadedButNotYetConfirmed = false;
		
		var login = "";	
		login = localStorage.getItem("SFL2018_login");
		console.log("login = "+login);
		$('input#loginField').val(login);
		$('input#loginField').hide();
		$(confirmed).hide();
		$(uploading).hide();
		$(allVideos).hide();
		$(err).hide();
		
		$.get( "/getuploads", function( data ) {
			console.log("Uploads = "+data);	

			for (i=0; i<data.length; i++ ){
				if (data[i][0].indexOf(login) > -1) { alreadyUploadedButNotYetConfirmed = true; }
			}
		
		
			$.get( "/getvideos", function( data ) {
				console.log("Videos = "+data);			
							
				for (i=0; i<data.length; i++ ){
					if (data[i].indexOf(login) > -1) { alreadyUploadedAndConfirmed = true;	}
				}
				
				if (login) {
					console.log("alreadyUploadedAndConfirmed = "+alreadyUploadedAndConfirmed);
					console.log("alreadyUploadedButNotYetConfirmed = "+alreadyUploadedButNotYetConfirmed);
				
					if (alreadyUploadedAndConfirmed) {
						for (i=0; i<data.length; i++ ){
							
							var video = document.createElement('video');
							video.playsinline = "true";
							video.controls = "true";
							video.width  = 320;
							video.height = 240;
							
							var source = document.createElement('source');
							source.src = data[i];
							
							video.appendChild(source);						
							listVideos.appendChild(video);
						}						
					
						$(confirmation).hide();
						$(confirmationLink).hide();
						$(allVideos).show();
						$(allVideosLink).show();
											
					} else {
					
						if (alreadyUploadedButNotYetConfirmed) {
							$(notyetconfirmed).hide();
							$(confirmed).show();
						}
						else {
							$(notyetconfirmed).show();
							$(allVideos).hide();
							$(confirmed).hide();
						}
					}				
				}
			});
		});

		$(function() {
			$("input:file").change(function (){
				var fileName = $(this).val();
				var parts = fileName.split('\\');
				var answer = parts[parts.length - 1];
				upload(fileName);
			});
		});
		
		function scrollTo(el) {		
			$('html, body').animate({
					scrollTop: $(el).offset().top
				}, 20);
		}

		function upload(fname) {
			var input = document.getElementById("fileInput");
			var fd = new FormData()
			fd.append('video', input.files[0]);	
				
			var ext = fname.substr(fname.lastIndexOf('.') + 1);
			console.log(ext);
		   
			if (fd && allowedExtensions.indexOf(ext.toLowerCase()) > -1)  {
			
				$(fname).html( fname );
				$(notyetconfirmed).hide();
				$(uploading).show();
				scrollTo("#confirmation");						
			
				var user = login;
				var xhr = new XMLHttpRequest();
				xhr.open("POST", "/upload");
				xhr.setRequestHeader("user", user);

				xhr.onreadystatechange = function () {
					var status;
					var data;
					if (xhr.readyState == 4) {
						status = xhr.status;
						if (xhr.status === 500) {
							$(err).show();
						} else {
							$(uploading).hide();
							$(confirmed).show();
							localStorage.setItem('sflconfirmation','succes')
							scrollTo("#confirmation");
						}
					}
				};
				xhr.onload = function () {};
				xhr.send(fd);
			} else { $(err_ext).show();	}
		}
		
   
	
    </script>
</body>

</html>